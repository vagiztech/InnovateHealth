# InnovateHealth
Project Practice 
# Классификация Рака Кожи с использованием пердобученной модели GoogLeNet

## Описание
### Описание модели
Решение используется для предварительного анализа возможного наличия злокачественного 
характера новообразования кожи по изображению и создания
рекомендации направления в специализированные медицинские организации.
Модель анализирует изображение, содержащее фотоснимок предполагаемого
злокачественного новообразования, и вносит данные в реестр предполагаемых онкопациентов в случае подозрения, либо выдает сообщение
о предполагаемом отсутствии злокачественного характера новообразования.

### Описание ресурса
Этот репозиторий содержит код для обучения и использования модели классификации рака кожи с использованием модели GoogLeNet. Модель обучается на датасете HAM10000, который содержит изображения кожных поражений с различными категориями, такими как меланома, базально-клеточная карцинома и другие.

## Требования 

Python 3.10.x

## Подготовительные рабрты

pip install -r requirements.txt

## Ссылки и ресурсы:

### Репозиторий с решением
https://github.com/vagiztech/InnovateHealth/tree/main

### Датасет
https://www.kaggle.com/datasets/kmader/skin-cancer-mnist-ham10000

### Файлы в репозитории:
1.  torch_model.py - Основной файл с решением
2. test_model.py - Тестирование модели, определение метрики точности
3. README.md - инструкция. Прочесть перед использованием
4. requirementst.txt - необходимые версии библиотек
5. kaggle.json - файл, содержащий ключ к датасету
6. weights30.pt - файл, содержащий веса (загруженные данные для работы модели)
7. папка content/data_cancer - папка с набором 20 тестировочных изображений

## Отчет
### Подготовка данных

Датасет загружается и подготавливается с использованием следующих шагов:
1. Загрузка ключа Kaggle API в Colab для скачивания датасета.
2. Датасет скачивается с https://www.kaggle.com/datasets/kmader/skin-cancer-mnist-ham10000 и извлекается.
3. Изображения сортируются по папкам на основе их классов (например, меланома, базально-клеточная карцинома) с использованием CSV-файла с метаданными для работы функции ImageFolder().


### Обучение модели

Предобученная модель GoogLeNet используется для обучения модели классификации. Шаги включают в себя:
1. Предобработка данных: изображения изменяют размер, обрезаются и нормализуются.
2. Разделение датасета: датасет разбивается на обучающий и валидационный наборы данных.
3. Создание модели: создается модель GoogLeNet и настраивается для задачи классификации.
4. Обучение: модель обучается на обучающих данных, и отслеживается потеря и точность.
5. Валидация: модель проверяется на валидационном наборе данных для проверки ее производительности.


## Тест модели

Для оценки модели доступны следующие функции:
1. `predict_image_class(image_path, model)`: по заданному пути к изображению она предсказывает класс кожного поражения.
2. `test_folder(Patch)`: выполняет тестирование модели на папке изображений и предоставляет количество предсказанных классов.

## Порядок работы:
1. Клонируйте удаленный репозиторий с решение на свой локальный репозиторий
2. Загрузите актуальные версии библитотек из файла requirement.txt
3. Запустите тестовый файл test_model.py
4. Запустите файл с моделью torch_mpdel.py
5. Загрузите ключ kaggle
6. Загрузите необходимое изображение: решение выдаст результат

